<div class="search-card">
  <div class="card">
    <div class="card-header">
      <h6><i [class]="icon" class="me-2"></i>{{ title }}</h6>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Filtri dinamici -->
        <div *ngFor="let filtro of filtri" [class]="getColSize(filtro)">
          <label [for]="filtro.id" class="form-label">{{ filtro.label }}</label>

          <!-- Input Text -->
          <input
            *ngIf="filtro.type === 'text'"
            type="text"
            class="form-control"
            [id]="filtro.id"
            [placeholder]="filtro.placeholder || ''"
            [ngModel]="filtro.value"
            (ngModelChange)="onFiltroChange(filtro.id, $event)">

          <!-- Select -->
          <select
            *ngIf="filtro.type === 'select'"
            class="form-select"
            [id]="filtro.id"
            [ngModel]="filtro.value"
            (ngModelChange)="onFiltroChange(filtro.id, $event)">
            <option value="">{{ filtro.placeholder || 'Seleziona...' }}</option>
            <option *ngFor="let option of filtro.options" [value]="option.value">
              {{ option.label }}
            </option>
          </select>

          <!-- Multi-select -->
          <select
            *ngIf="filtro.type === 'multiselect'"
            class="form-select"
            [id]="filtro.id"
            multiple
            [ngModel]="filtro.value"
            (ngModelChange)="onFiltroChange(filtro.id, $event)">
            <option *ngFor="let option of filtro.options" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>

        <!-- Pulsante Pulisci -->
        <div *ngIf="showClearButton" class="col-md-2 d-flex align-items-end">
          <button type="button" class="btn btn-outline-secondary w-100" (click)="onClearFiltri()">
            <i class="fas fa-times me-1"></i>{{ clearButtonText }}
          </button>
        </div>
      </div>

      <!-- Contenuto aggiuntivo (slot per checkbox, ecc.) -->
      <div *ngIf="additionalContent" class="row mt-3">
        <div class="col-12">
          <ng-container [ngTemplateOutlet]="additionalContent"></ng-container>
        </div>
      </div>

      <!-- Checkbox separati (per compatibilitÃ ) -->
      <div class="row mt-3">
        <div *ngFor="let filtro of filtri" class="col-md-3">
          <div *ngIf="filtro.type === 'checkbox'" class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              [id]="filtro.id"
              [ngModel]="filtro.value"
              (ngModelChange)="onFiltroChange(filtro.id, $event)">
            <label class="form-check-label" [for]="filtro.id">
              {{ filtro.label }}
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
